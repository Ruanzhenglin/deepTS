<tool id="TS_plot" name="Expression pattern visualization" version="19.09">
	<description>
	</description>
	
	<command>
		#if $plotTS.TStype == "pairwise"
			Rscript ${__tool_directory__}/annotateTS/03_plot_pairwiseTS.R --tooldir ${__tool_directory__} --sqlitedb $sqlitedb 
				--iso1 $isopair.iso1 --iso2 $isopair.iso2  --group_select $isopair.group --structure_type $plot_iso.structure_type  --imagefile $out_pairwiseTS_image
		#elif $plotTS.TStype == "time_series"
			Rscript ${__tool_directory__}/annotateTS/03_plot_timeSeriesTS.R --tooldir ${__tool_directory__} --sqlitedb $sqlitedb 
				--iso1 $isopair.iso1 --iso2 $isopair.iso2 --group $isopair.group  --structure_type $plot_iso.structure_type --imagefile $out_timeSeriesTS_image
		#elif $plotTS.TStype == "population"
			Rscript ${__tool_directory__}/annotateTS/03_plot_popTS.R --tooldir ${__tool_directory__} --sqlitedb $sqlitedb 
				--iso1 $isopair.iso1	--iso2 $isopair.iso2 --snpID $isopair.group --structure_type $plot_iso.structure_type --imagefile $out_popTS_image
		#end if
	</command>
	
	<inputs>
		<param name="sqlitedb" type="data" optional="True" label="SQLite database" />
		<param name="tsRes" type="data" optional="True" label="TS events matrix" />	
		<section name="isopair" title="Transcript ID" expanded="True">
			<param name="group" type="select" optional="true" multiple="false" label="group or SNP ID">
				<options from_dataset="tsRes">
					<column name="name" index="0"/>
					<column name="value" index="0"/>
					<filter type="unique_value" name="unique_group" column="0"/>
					<filter type="sort_by" name="sorted_group" column="0"/>
				</options>
				<sanitizer>
					<valid initial="default">
						<add preset="string.printable"/>
						<add value=";"/>
						<remove value="&quot;"/>
						<remove value="&apos;"/>
					</valid>
				</sanitizer>
			</param>
			<param name="iso1" type="select" optional="true" multiple="false" label="Transcript1 ID">
				<options from_dataset="tsRes">
					<column name="name" index="2"/>
					<column name="value" index="2"/>
					<filter type="unique_value" name="unique_iso1" column="2"/>
					<filter type="sort_by" name="sorted_iso1" column="2"/>
				</options>
				<sanitizer>
					<valid initial="default">
						<add preset="string.printable"/>
						<add value=";"/>
						<remove value="&quot;"/>
						<remove value="&apos;"/>
					</valid>
				</sanitizer>
			</param>
			<param name="iso2" type="select" optional="true" multiple="false" label="Transcript2 ID">
				<options from_dataset="tsRes">
					<column name="name" index="3"/>
					<column name="value" index="3"/>
					<filter type="unique_value" name="unique_iso2" column="3"/>
					<filter type="sort_by" name="sorted_iso2" column="3"/>
				</options>
				<sanitizer>
					<valid initial="default">
						<add preset="string.printable"/>
						<add value=";"/>
						<remove value="&quot;"/>
						<remove value="&apos;"/>
					</valid>
				</sanitizer>
			</param>
		</section>
		<conditional name="plot_iso">
			<param name="structure_type" type="select" label="Select elements of transcript structure to display">
				<option value="exon_intron">Exon and Intron</option>				
				<option value="cds_utr_intron">CDS, UTR and Intron</option>	
			</param>
			<when value="exon_intron">				
			</when>
			<when value="cds_utr_intron">	
			</when>		
		</conditional>
		<conditional name="plotTS">
			<param name="TStype" type="select" optional="true" multiple="false" label="Select TS event types?">
				<option value="pairwise">pairwise TS events</option>				
				<option value="time_series">time-series TS events</option>
				<option value="population">popultaion TS events</option>
			</param>
			<when value="pairwise">				
			</when>
			<when value="time_series">	
			</when>
			<when value="population">	
			</when>			
		</conditional>

	</inputs>
	<stdio>
		<exit_code range="1:"  level="fatal" description="Error Running plot of TS events" />
	</stdio>	
	<outputs>
	  	<data name="out_pairwiseTS_image" label="Visualization a pairwise TS event" format="pdf">
			<filter>plotTS['TStype'] == "pairwise"</filter>
		</data>	
	  	<data name="out_timeSeriesTS_image" label="Visualization a time-series TS event" format="pdf">
			<filter>plotTS['TStype'] == "time_series"</filter>
		</data>		
		<data name="out_popTS_image" label="Visualization of a popultaion TS event" format="pdf">
			<filter>plotTS['TStype'] == "population"</filter>
		</data>
	</outputs>
	
	<help>
	.. class:: infomark

    **What it does**

     This function can be used to display expression pattern, Exon-intron structure and protein domain of transcripts in TS events.

	.. class:: infomark

	**Inputs**

	* **Sqlite database**:  a SQLite file generated by **Create SQLite file** in other tools..	

	* **Transcript ID**: Select transcript ID from a TS event in SQLite file.

	.. class:: infomark

	**Outputs**

	* **Visualization of a TS event**
	</help>
</tool>

